#include<stdio.h>
#include<string.h>
#include <stdlib.h>
#include<conio.h>
#include<windows.h>
char square[10]={'0','1','2','3','4','5','6','7','8','9'};
char p1[20],p2[20],p3[30];
void instruction();
void entername();
int whowillplayfirst();
void drawboard(char [],char[]);
void playgame(int);
int checkwin();
void result(int,int);

void instruction()
{
    char e;
    printf("\t\t\t\tWELCOME IN THE TIC-TAC-TOE GAME\n\n");
    printf("INSTRUCTIONS\n\n");
    printf("Won: When any player succeds in placing three of their marks in a Horizontal, Vertical, Diagonal Row.\n\n");
    printf("Tie: When no make any pair.\n");
    printf("\nPRESS P TO PLAY THE GAME\n");
    scanf("%s",&e);

}

void entername()
{
    system("cls");
    printf("Enter player name of X: ");
    getchar();
    gets(p1);
    printf("\nEnter player name of 0: ");
    gets(p2);
}

int whowillplayfirst()
{
    int r1,r2;

    printf("\n\nWho will play first %s or %s\n\t",p1,p2);
    gets(p3);
    r1=strcmp(p1,p3);
    r2=strcmp(p2,p3);

    if(r1==0 || r2==0)
    {
        if(r1==0)
        {
            return 1;
        }
        else
        {
            return 2;
        }
    }
    else
    {
        return 3;
    }
}


void drawboard(char p1[],char p2[])
{
    system("cls");
    printf("\n\n Tic Tac Toe \n\n");
    printf("%s=>X v/s %s=>0\n\n",p1,p2);
    printf("    |    |    \n");
    printf("  %c  |  %c  |  %c  \n",square[1],square[2],square[3]);
    printf("    |    |    \n");
    printf("  %c  |  %c  |  %c  \n",square[4],square[5],square[6]);
    printf("    |    |    \n");
    printf("    |    |    \n");
    printf("  %c  |  %c  |  %c  \n",square[7],square[8],square[9]);
    printf("    |    |    \n");
}

void playgame(int player)
{
    char mark;
    int i,choice;

    if(player==1 || player==2)
    {
            drawboard(p1,p2);
          do{
        player=(player%2)?1:2;
        if(player==1)
        {
        printf("%s Enter your choice:",p1);
        }
        else
        {
            printf("%s Enter your choice:",p2);
        }
        scanf("%d",&choice);
        mark=(player%2)?'X':'0';
        if(choice==1&&square[1]=='1')
            square[1]=mark;
        else if(choice==2&&square[2]=='2')
            square[2]=mark;
        else if(choice==3&&square[3]=='3')
            square[3]=mark;
             else if(choice==4&&square[4]=='4')
            square[4]=mark;
             else if(choice==5&&square[5]=='5')
            square[5]=mark;
             else if(choice==6&&square[6]=='6')
            square[6]=mark;
             else if(choice==7&&square[7]=='7')
            square[7]=mark;
             else if(choice==8&&square[8]=='8')
            square[8]=mark;
             else if(choice==9&&square[9]=='9')
            square[9]=mark;

            else{
                printf("Invalid Option!");
                player--;
                getch();
            }
            i=checkwin();
            player++;
            drawboard(p1,p2);
    }while(i==-1);

     result(i,player);
}
}

int checkwin()
{
    if(square[1]==square[2]&&square[2]==square[3])
        return 1;
    else if(square[4]==square[5]&&square[5]==square[6])
        return 1;
    else if(square[7]==square[8]&&square[8]==square[9])
       return 1;
    else if(square[1]==square[4]&&square[4]==square[7])
        return 1;
    else if(square[2]==square[5]&&square[5]==square[8])
        return 1;
    else if(square[3]==square[6]&&square[6]==square[9])
          return 1;
    else if(square[1]==square[5]&&square[5]==square[9])
          return 1;
    else if(square[3]==square[5]&&square[5]==square[7])
          return 1;
    else if(square[1]!='1' && square[2]!='2' && square[3]!='3'&&square[4]!='4' && square[5]!='5' && square[6]!='6' && square[7]!='7'&&square[8]!='8'&&square[9]!='9')
          return 0;
    else
        return -1;
}


void result(int i,int player)
{
    system("cls");
    if(i==1){
            --player;
    if(player==1)
    {
        printf("\n\n\n\n\n\t\t\t\t%s WON THE GAME",p1);
    }
    else
    {
       printf("\n\n\n\n\n\t\t\t\t%s WON THE GAME",p2);
    }
    }
    else{
        printf("\n\n\n\n\n\t\t\t\tGAME DRAW");
    }
    getch();
}

int main()
{
    int player;
    instruction();
    entername();
    player=whowillplayfirst();

   if(player==1 || player==2)
   {
       playgame(player);
   }
    else
    {
        printf("invalid player");
    }
}
